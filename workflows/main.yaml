workflows:
  - name: main
    version: 0.1.0
    description: |
      The `main` workflow is the default workflow in `CID` if no workflow name is provided.

      It contains the following stages, with conditional actions based on the project type.
    rules: []
    stages:
      - name: build
        actions:
          - id: cid-actions/go-build
          - id: cid-actions/java-build
          - id: cid-actions/dotnet-build
          - id: cid-actions/python-build
          - id: cid-actions/node-build
          - id: cid-actions/hugo-build
          - id: cid-actions/helm-build
          - id: cid-actions/mkdocs-build
          - id: cid-actions/techdocs-build
      - name: test
        actions:
          - id: cid-actions/go-test
          - id: cid-actions/java-test
          - id: cid-actions/dotnet-test
      - name: lint
        actions:
          - id: cid-actions/ansible-lint
          #- id: cid-actions/python-lint
          - id: cid-actions/helm-lint
          - id: cid-actions/renovate-lint
      - name: package
        actions:
          - id: cid-actions/upx-optimize
          - id: cid-actions/buildah-build
            config:
              no-cache: false
              squash: true
              rebuild: true
      - name: scan
        actions:
          - id: cid-actions/java-gradle-wrapper-scan
          #- id: cid-actions/ossf-scorecard-scan
          #- id: cid-actions/gitleaks-scan
          - id: cid-actions/semgrep-scan
          #- id: cid-actions/fossa-source-scan
          - id: cid-actions/sonarqube-scan
          - id: cid-actions/qodana-scan
          #- id: cid-actions/syft-artifact-sbom-generate
          - id: cid-actions/syft-container-sbom-generate
          - id: cid-actions/zizmor-scan
          - id: cid-actions/github-sarif-upload
      - name: publish
        actions:
          # container - publish to registry
          - id: cid-actions/buildah-publish
          # java library - publish
          - id: cid-actions/java-publish
          # container - sign image
          #- id: cid-actions/cosign-container-sign
          # container - attach and sign sbom
          #- id: cid-actions/cosign-container-sbom-attach
          # helm charts
          - id: cid-actions/helm-publish-nexus
          - id: cid-actions/helm-publish-registry
          # docs - techdocs - publish
          - id: cid-actions/techdocs-publish
          # changelog
          - id: cid-actions/changelog-generate
          # release - github
          - id: cid-actions/github-release-publish
      - name: deploy
        actions:
          - id: cid-actions/ansible-deploy
